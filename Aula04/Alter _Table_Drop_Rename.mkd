# ALTER TABLE, DROP e RENAME

## Gerenciamento de Tabelas no SQL Server

Nesta aula, vamos aprender como **alterar, excluir e renomear tabelas** no SQL Server. Esses comandos s√£o muito usados no dia a dia, principalmente quando o banco j√° existe e precisa de **ajustes ou manuten√ß√£o**.

Vamos focar nos comandos:

* `ALTER TABLE`
* `DROP TABLE`
* `sp_rename`

Sempre com exemplos pr√°ticos.

---

## 1. Conceito geral: ALTER TABLE

O comando `ALTER TABLE` √© usado para **modificar a estrutura de uma tabela existente**, sem precisar apag√°-la.

Sintaxe geral:

```sql
ALTER TABLE NomeTabela
ADD | ALTER | DROP Objeto;
```

Com ele, podemos:

* Adicionar colunas
* Alterar tipos de dados
* Remover colunas
* Adicionar ou remover constraints

---

## 2. Adicionando uma nova coluna

Vamos adicionar uma coluna de teste chamada **Edi√ß√£o** na tabela `Livro`.

```sql
ALTER TABLE Livro
ADD Edicao SMALLINT;
```

 A coluna ser√° criada:

* No final da tabela
* Permitindo `NULL` por padr√£o (se n√£o for especificado `NOT NULL`)

---

## 3. Alterando o tipo de dado de uma coluna

Caso a coluna tenha sido criada com um tipo inadequado, podemos alter√°-la.

```sql
ALTER TABLE Livro
ALTER COLUMN Edicao TINYINT;
```

‚ö†Ô∏è Aten√ß√£o:

* A altera√ß√£o s√≥ funciona se os dados existentes forem compat√≠veis
* Caso contr√°rio, o SQL Server retornar√° erro

---

## 4. Adicionando uma chave prim√°ria com ALTER TABLE

Tamb√©m √© poss√≠vel criar uma **PRIMARY KEY** ap√≥s a tabela j√° existir.

```sql
ALTER TABLE NomeTabela
ADD CONSTRAINT pk_nome PRIMARY KEY (Coluna);
```

 Boa pr√°tica: sempre nomear a constraint.

---

## 5. Excluindo uma constraint

Para remover uma constraint, primeiro precisamos saber o **nome dela**.

### 5.1 Descobrindo o nome das constraints

```sql
sp_help Livro;
```

Esse comando mostra:

* Colunas
* Tipos de dados
* Constraints
* Chaves prim√°rias e estrangeiras

---

### 5.2 Removendo a constraint

```sql
ALTER TABLE NomeTabela
DROP CONSTRAINT NomeConstraint;
```

 Muito usado para remover:

* `CHECK`
* `UNIQUE`
* `FOREIGN KEY`

---

## 6. Excluindo uma coluna de uma tabela

Se uma coluna n√£o for mais necess√°ria, podemos remov√™-la.

```sql
ALTER TABLE Livro
DROP COLUMN Edicao;
```

‚ö†Ô∏è Cuidado:

* A exclus√£o √© definitiva
* Dados dessa coluna ser√£o perdidos

---

## 7. Excluindo uma tabela inteira

Para apagar completamente uma tabela do banco:

```sql
DROP TABLE NomeTabela;
```

 Observa√ß√µes importantes:

* A tabela √© removida permanentemente
* Se houver relacionamento com outras tabelas, pode ocorrer erro

---

## 8. Renomeando uma tabela

O SQL Server usa a procedure `sp_rename` para renomear objetos.

```sql
sp_rename 'Livro', 'Livros';
```

 Isso altera apenas o nome da tabela, n√£o os dados.

‚ö†Ô∏è Aten√ß√£o:

* Stored procedures, views e c√≥digo da aplica√ß√£o podem quebrar
* Use com cuidado em ambientes de produ√ß√£o

---

## Resumo 

```text
Adicionar coluna:      ALTER TABLE ADD
Alterar coluna:        ALTER TABLE ALTER COLUMN
Excluir coluna:        ALTER TABLE DROP COLUMN
Excluir constraint:    ALTER TABLE DROP CONSTRAINT
Excluir tabela:        DROP TABLE
Renomear tabela:       sp_rename
```

---

Os comandos de gerenciamento de tabelas permitem **evoluir o banco de dados sem recri√°-lo do zero**. Saber usar corretamente `ALTER TABLE`, `DROP` e `sp_rename` √© essencial para manuten√ß√£o, corre√ß√£o de erros e adapta√ß√£o √†s regras do neg√≥cio.

üìå Sempre revise bem antes de executar comandos destrutivos, principalmente em produ√ß√£o.
